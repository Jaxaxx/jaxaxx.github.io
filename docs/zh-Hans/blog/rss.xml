<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Jaxaxx Blog</title>
        <link>https://jaxaxx.github.io/zh-Hans/blog</link>
        <description>Jaxaxx Blog</description>
        <lastBuildDate>Tue, 02 Apr 2024 22:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hans</language>
        <item>
            <title><![CDATA[nexus搭建apt私有仓库]]></title>
            <link>https://jaxaxx.github.io/zh-Hans/blog/nexus-apt-repositoy</link>
            <guid>https://jaxaxx.github.io/zh-Hans/blog/nexus-apt-repositoy</guid>
            <pubDate>Tue, 02 Apr 2024 22:00:00 GMT</pubDate>
            <description><![CDATA[- 参考链接]]></description>
            <content:encoded><![CDATA[<ul>
<li><a href="https://blog.csdn.net/qq_44214446/article/details/128272077" target="_blank" rel="noopener noreferrer">参考链接</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="生成密钥">生成密钥<a href="https://jaxaxx.github.io/zh-Hans/blog/nexus-apt-repositoy#%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5" class="hash-link" aria-label="生成密钥的直接链接" title="生成密钥的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">在nexus所在机器生成密钥</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 生成密钥，最后会有个输入密码的地方，这个密钥是在nexus创建本地库需要用到的，要记住</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@cb286ec8aef8 sonatype]# sudo gpg --full-generate-key --pinentry-mode=loopback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 验证密钥生成好了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@cb286ec8aef8 sonatype]# gpg --list-keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/root/.gnupg/pubring.kbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub   rsa2048 2024-04-01 [SC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CC29D60F635358A2123658F148EE12A3EB661AB3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid           [ultimate] fftai &lt;soft@fftai.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub   rsa2048 2024-04-01 [E]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 导出公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpg -a -o nexus_pub.asc --export fftai （最后这个fftai就是生成时候的name字段，要对应）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 导出私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpg -a -o nexus_pri.asc --export-secret-key fftai （同上）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 到此 公钥私钥名称分别是 nexus_pub.asc nexus_pri.asc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在nexus服务器上生成密钥对(如果是docker一定要到容器里边区生成)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - 注意选择如下：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1.密钥种类选择RSA：1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2.密钥长度：2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3.密钥永不过期：0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4.用户标识：（姓名、电子邮件、注释）方便识别即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 5.密钥保护：该密码是私钥的保护密码，需牢记</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 6.密钥生成成功</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建apt-hosted仓库">创建apt-hosted仓库<a href="https://jaxaxx.github.io/zh-Hans/blog/nexus-apt-repositoy#%E5%88%9B%E5%BB%BAapt-hosted%E4%BB%93%E5%BA%93" class="hash-link" aria-label="创建apt-hosted仓库的直接链接" title="创建apt-hosted仓库的直接链接">​</a></h2>
<ol>
<li>在浏览器访问nexus</li>
<li>创建仓库apt-hosted，<!-- -->
<ul>
<li>Name：自定义一个名称，创建后无法重命名，注意命名。这里是aptHosted。</li>
<li>online：存储库是否接受传入的请求。默认勾选，允许向此仓库推入deb包。</li>
<li>Distribution：系统版本标识。这里系统为Ubuntu 20.04，版本代号为focal。</li>
<li>Signing Key：添加之前服务器端生成的pgp私钥。</li>
<li>Passphrase：填写pgp私钥的保护密码。</li>
<li>Blob store：我们下拉选择前面创建好的专用存储区apt。</li>
<li>Strict Content Type Validation：默认勾选，验证所有路径都是deb或apt元数据。</li>
<li>Deployment policy：部署策略，控制对是否允许工件进行部署和更新，下拉选择Allow redeploy（允许重新部署）。</li>
<li>最后点击Create repository创建仓库</li>
</ul>
</li>
</ol>
<h1>注册指纹</h1>
<p>到 <a href="http://keyserver.ubuntu.com/" target="_blank" rel="noopener noreferrer">http://keyserver.ubuntu.com/</a> 注册指纹</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">在nexus所在机器执行</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@cb286ec8aef8 sonatype]# gpg --list-keys --keyid-format LONG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/root/.gnupg/pubring.kbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub   rsa2048/48EE12A3EB661AB3 2024-04-01 [SC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CC29D60F635358A2123658F148EE12A3EB661AB3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid                 [ultimate] fftai &lt;soft@fftai.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub   rsa2048/454A4FF6FBA56D48 2024-04-01 [E]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 把48EE12A3EB661AB3输入到上面的网站，然后点击Submit key 下一步把公钥拷贝进去确认提交就可以了</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="客户端使用">客户端使用<a href="https://jaxaxx.github.io/zh-Hans/blog/nexus-apt-repositoy#%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="客户端使用的直接链接" title="客户端使用的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">客户端机器使用</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 添加公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 48EE12A3EB661AB3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 添加私有服务器地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo add-apt-repository "deb [arch=amd64] http://127.0.0.1:8081/repository/apt-hosted focal main"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 更新库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get update -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>nexus</category>
            <category>apt</category>
            <category>ubuntu</category>
        </item>
    </channel>
</rss>